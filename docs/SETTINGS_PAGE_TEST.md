# 设置页面测试指南

## 访问设置页面

开发服务器已启动：**http://localhost:5174/**

访问设置页面：**http://localhost:5174/settings**

## 测试功能清单

### 1. 用户信息显示 ✅
**测试步骤：**
- 访问设置页面
- 查看"用户信息"区域

**预期结果：**
- 显示当前模式（拥有者模式/访客模式）
- 如果已登录，显示用户名
- 如果已配置，显示 Gist ID

---

### 2. Token 管理 ✅
**测试步骤：**

#### 2.1 查看 Token 状态
- 在"Token 管理"区域查看 Token 状态
- 应显示"已配置"或"未配置"

#### 2.2 配置/更新 Token
1. 点击"配置 Token"或"更新 Token"按钮
2. 输入 GitHub Personal Access Token
   - 格式：`ghp_xxxxxxxxxxxxxxxxxxxx`
   - 需要 `gist` 权限
3. 点击"保存"按钮

**预期结果：**
- Token 验证成功后保存
- 显示成功提示
- Token 状态更新为"已配置"

#### 2.3 删除 Token
1. 点击"删除 Token"按钮
2. 确认删除操作

**预期结果：**
- Token 被删除
- 显示成功提示
- Token 状态更新为"未配置"

#### 2.4 获取 Token 指南
- 点击"如何获取 Token？"链接
- 应在新标签页打开 GitHub Token 创建页面

---

### 3. 同步状态 ✅
**测试步骤：**
- 查看"同步状态"区域（仅拥有者模式）
- 查看最后同步时间
- 查看待同步变更数量
- 点击"立即同步"按钮

**预期结果：**
- 显示正确的同步时间（刚刚/X分钟前/X小时前等）
- 显示待同步变更数量
- 手动同步成功后显示提示

---

### 4. 数据导出 ✅
**测试步骤：**
1. 在"数据管理"区域找到"导出数据"部分
2. 点击"导出数据"按钮

**预期结果：**
- 自动下载 JSON 文件
- 文件名格式：`personal-knowledge-backup-YYYY-MM-DD.json`
- 文件包含所有数据（resources, questions, subQuestions, answers, metadata）
- 显示成功提示

**验证导出的数据：**
```json
{
  "version": "1.0.0",
  "exportDate": "2024-11-13T...",
  "data": {
    "resources": [...],
    "questions": [...],
    "subQuestions": [...],
    "answers": [...],
    "metadata": {...}
  }
}
```

---

### 5. 数据导入 ✅
**测试步骤：**
1. 在"数据管理"区域找到"导入数据"部分
2. 点击"导入数据"按钮
3. 选择之前导出的 JSON 文件
4. 查看确认对话框中的数据统计
5. 确认导入

**预期结果：**
- 显示数据统计（资源数量、问题数量等）
- 确认后导入数据
- 显示成功提示
- 页面自动刷新以加载新数据

**错误处理测试：**
- 尝试导入无效的 JSON 文件
- 应显示错误提示

---

### 6. 存储使用情况 ✅
**测试步骤：**
- 查看"存储使用情况"区域
- 查看缓存大小、资源数量、问题数量

**预期结果：**
- 显示正确的统计信息
- 缓存大小格式：XX KB 或 XX MB

---

### 7. 清除缓存 ✅
**测试步骤：**
1. 点击"清除缓存"按钮
2. 确认操作

**预期结果：**
- 缓存被清除
- 显示成功提示
- 存储使用情况更新

---

### 8. 退出登录 ✅
**测试步骤：**
1. 点击"退出登录"按钮（仅拥有者模式）
2. 确认操作

**预期结果：**
- 清除所有本地数据和配置
- 显示成功提示
- 重定向到首页

---

## 测试场景

### 场景 1：新用户首次配置
1. 访问设置页面
2. Token 状态显示"未配置"
3. 配置 Token
4. 查看同步状态
5. 导出数据作为备份

### 场景 2：更新 Token
1. 访问设置页面
2. Token 状态显示"已配置"
3. 点击"更新 Token"
4. 输入新的 Token
5. 保存并验证

### 场景 3：数据迁移
1. 在设备 A 上导出数据
2. 在设备 B 上访问设置页面
3. 导入之前导出的数据
4. 验证数据完整性

### 场景 4：清理和重置
1. 清除缓存
2. 删除 Token
3. 退出登录
4. 验证所有数据已清除

---

## 常见问题

### Q: Token 验证失败
**A:** 确保 Token 具有 `gist` 权限，并且格式正确（以 `ghp_` 开头）

### Q: 导入数据失败
**A:** 检查 JSON 文件格式是否正确，确保是从本应用导出的数据

### Q: 同步失败
**A:** 检查网络连接和 Token 是否有效

---

## 自动化测试建议

建议编写以下自动化测试：

1. **Token 管理测试**
   - Token 验证
   - Token 保存和删除
   - Token 加密存储

2. **数据导出测试**
   - 导出数据格式验证
   - 导出文件完整性检查

3. **数据导入测试**
   - 有效数据导入
   - 无效数据拒绝
   - 数据验证逻辑

4. **UI 交互测试**
   - 按钮点击
   - 表单提交
   - 错误提示显示

---

## 性能测试

- 导出大量数据（1000+ 资源）的性能
- 导入大量数据的性能
- 页面加载速度

---

## 浏览器兼容性测试

测试以下浏览器：
- ✅ Chrome/Edge (最新版本)
- ✅ Firefox (最新版本)
- ✅ Safari (最新版本)

---

## 移动端测试

- 响应式布局
- 触摸交互
- 文件选择器

---

## 反馈

如果发现任何问题，请记录：
1. 问题描述
2. 重现步骤
3. 预期结果 vs 实际结果
4. 浏览器和版本
5. 错误日志（如果有）
